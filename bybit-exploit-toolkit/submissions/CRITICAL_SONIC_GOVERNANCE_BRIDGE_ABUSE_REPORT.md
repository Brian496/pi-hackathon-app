# Critical — Governance/Bridge Role Abuse Enables Unbacked Mint and Cross-Chain Drain (Sonic Ecosystem)

## Executive Summary
- Vulnerability: Admin/Bridge role abuse enabling unbacked mint, under-collateralized borrowing, and cross-chain asset drain
- Impact: Protocol fund loss, insolvency of wrapped assets, cross-protocol contagion (stablecoins, lending markets)
- Severity: Critical
- Context: Pattern observed during the CrediX incident (Aug 2025) on Sonic, likely applicable to similarly designed protocols

## Affected Components
- ACL / Role Manager (grant/revoke/elevate administrative privileges)
- Governance controls (multisig, timelock, guardians)
- Bridge mint/burn contracts on Sonic ↔ L1
- Lending/collateral modules (mint-receipt/borrow flows)

## Technical Details
Many Sonic protocols expose privileged roles (e.g., `ADMIN_ROLE`, `BRIDGE_ROLE`, or owner) that can:
1) Mint/burn wrapped assets on Sonic (bridge side) without rigorous timelock/quorum or rate limits.
2) Mint synthetic/collateral/receipt tokens that are subsequently usable as lending collateral.
3) Modify ACL/roles via a multisig/owner without delay or multi-party confirmation.

In this configuration, an attacker who obtains/abuses a privileged role can:
- Mint unbacked wrapped assets on Sonic and redeem them cross-chain; or
- Mint synthetic collateral/receipt tokens and borrow real liquidity within the same transaction (amplified by flash loans), draining pools.

Key risk indicators:
- `RoleGranted`/`OwnershipTransferred`/`grantRole` events occurring without a timelock delay window.
- Bridge `mint`/`burn` callable by a single role with no daily/epoch caps or rate limits.
- Lending `borrow()` succeeding immediately after a large intra-transaction increase in collateral token `totalSupply`.

## Attack Path
1) Gain/abuse `ADMIN`/`BRIDGE` (or equivalent) role via compromised key, misconfigured ACL, or rushed multisig change.
2) Mint synthetic collateral/receipt tokens OR mint wrapped assets on the bridge side.
3) Borrow real assets against freshly minted collateral OR redeem wrapped assets cross-chain.
4) Bridge out and consolidate funds on L1.

## Proof of Concept Checklist (What to Verify)
- Enumerate contracts and roles:
  - ACL/Role manager: functions `grantRole`, `setRoleAdmin`, `transferOwnership` (who can call, any delay?).
  - Bridge contracts: `mint`, `burn`, `finalizeInbound`, limits and who authorizes them.
  - Lending: Is collateral token supply allowed to increase intra-tx before `borrow()` without sanity checks?
- Confirm lack of timelock/quorum/guardian for role changes and bridge mints.
- Confirm absence of per-epoch mint quotas, rate limits, or circuit breakers for bridge/lending.
- Simulate: mint collateral → call `borrow()` in same tx with a flash loan; verify pool drain feasibility.

Example reference (incident):
- CrediX, Aug 2025: Admin/Bridge roles added days prior → flash-loan-assisted borrow against fake collateral → funds bridged to Ethereum → downstream stablecoins unbacked.

## Impact
- Direct: Loss of protocol funds/TVL; insolvency of wrapped assets.
- Indirect: Downstream protocols holding affected stablecoins/assets accrue bad debt; redemptions halted.
- Systemic: Erodes confidence in Sonic ecosystem governance and bridge safety.

## Remediation Guidance
- Governance & ACL
  - Enforce timelocked, quorum-gated role changes; distinct signer sets; require off-chain + on-chain attestations.
  - Add guardian/pauser with narrowly scoped authority to halt critical flows.
- Bridge Controls
  - Per-epoch mint quotas and rolling rate limits; anomaly detection on large/rapid mints/burns.
  - Require multi-party confirmations for high-value bridge actions.
- Lending Safeguards
  - Disallow borrowing against freshly minted collateral within the same tx/block; impose cooldown windows.
  - Add sanity caps on collateralization changes per block.
- Monitoring
  - Real-time alerts for role changes, multisig signer updates, timelock parameter edits.
  - Alerts for bridge mints/burns above thresholds and single-block mega-borrows.

## Severity Justification
- Single-point role abuse enables unbounded fund loss and cross-chain insolvency.
- Exploit can execute atomically (flash loans), leaving near-zero reaction time.
- Demonstrated in-the-wild with multi-million USD impact and downstream contagion.

## Affected (To Be Completed During Submission)
- Protocol: <Name>
- Contracts: <addresses & ABIs>
- Roles: <role IDs/accounts>
- Networks: Sonic, L1 bridge counterpart

## Reproduction / Evidence (To Attach)
- Role/ownership event logs around the change window
- Transactions demonstrating mint-then-borrow feasibility (simulation)
- Screenshots/logs of missing timelock/quorum and rate limits

## Mitigation Plan (Proposed Timeline)
- Immediate: Freeze privileged mint paths; enable guardian pauses; cap borrowing.
- Short-term (<= 7 days): Deploy timelock config; add quotas and block-level sanity checks.
- Medium-term (<= 30 days): Refactor ACL; separate duties; comprehensive monitoring & runbooks.

## Submission Checklist
- [ ] Reproduction steps / tx sims attached
- [ ] Affected contracts/roles enumerated
- [ ] Logs/screenshots included
- [ ] Concrete remediation steps provided
- [ ] Business impact quantified

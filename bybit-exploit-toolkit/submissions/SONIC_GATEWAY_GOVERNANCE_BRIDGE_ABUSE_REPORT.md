# Critical — Sonic Gateway Governance/Bridge Role Abuse Enables Unbacked Mint and Cross-Chain Drain

## Executive Summary
- **Vulnerability**: Privileged role abuse and insufficient controls in Sonic Gateway may enable unbacked minting and cross-chain fund drains
- **Impact**: Systemic risk across bridged assets (e.g., EURC and other ERC-20s), insolvency, and contagion to integrated protocols
- **Severity**: Critical
- **Context**: Aligns with issues highlighted in public audits (OpenZeppelin, Dec 2024) and community discussions (Aave governance on EURC mint authority)

## Target and Scope
- **Protocol**: Sonic Gateway (Ethereum ↔ Sonic bridge)
- **Components**: UpdateManager, Gateway core contracts, TokenDeposit (L1), token adapters (e.g., CircleTokenAdapter), validator/guardian sets
- **Networks**: Ethereum (L1) and Sonic mainnet

## Technical Details
Sonic Gateway facilitates ERC-20 bridging via deposit on Ethereum and mint on Sonic. Administrative paths (governance/validators) can:
1) Approve and finalize bridge messages leading to token mints on Sonic
2) Update critical parameters/contracts (e.g., via UpdateManager)
3) Control adapter contracts with mint/burn privileges (e.g., CircleTokenAdapter for EURC)

Documented risks (public sources):
- OpenZeppelin audit (Dec 2024) noted a high-severity issue: incorrect update order in UpdateManager; several medium/low issues (e.g., user-provided ID collisions)
- Aave governance discussion (EURC on Sonic) recognized the Gateway’s authority to call `mint` on CircleTokenAdapter, implying compromise could enable unlimited EURC minting on Sonic

Risk Indicators in Code/Design:
- Single-role or insufficiently timelocked authority to trigger mints/burns
- Lack of per-epoch quotas/rate limits for bridge mints
- Reliance on validator set without quorum thresholds that align with asset risk
- Administrative update flows that can reorder or bypass intended sequencing (UpdateManager ordering)

## Attack Path (Representative)
1) Gain/abuse privileged role (validator quorum, admin key, misconfigured UpdateManager)
2) Approve or craft messages that invoke adapter `mint` on Sonic (e.g., EURC), or update adapter params to weaken checks
3) Mint unbacked assets on Sonic and redeem/swap across venues; optionally bridge-out to L1 counterparts if flow allows
4) Launder via cross-chain swaps; systemic insolvency for affected assets follows

## Proof of Concept Checklist (What to Verify)
- Enumerate contracts and roles:
  - UpdateManager: who can schedule/execute updates? Is there timelock? Correct update order enforced?
  - Gateway core/validators: required quorum; slashing/monitoring; who signs finalize?
  - Adapters (e.g., CircleTokenAdapter): presence of `mint`/`burn` functions; caller authorization; rate limits/quotas
- Validate governance controls:
  - Existence of timelocks, guardian/pauser roles, multi-party confirmations for high-value mints
  - Per-epoch or rolling mint caps; anomaly detection thresholds
- Simulation ideas:
  - Attempt to exceed nominal mint caps (devnet/test) and observe enforcement
  - Reorder update operations to detect unsafe intermediate states (UpdateManager order)
  - Negative tests for validator threshold and message replay/ID collisions

References for context (public):
- OpenZeppelin: Sonic Gateway audit (Dec 2024) — high-severity update order issue; multiple medium/low
- Aave governance: EURC on Sonic — Gateway has authority to call `mint` on CircleTokenAdapter

## Impact
- **Direct**: Unbacked asset creation on Sonic, de-pegs, insolvency
- **Indirect**: Cross-protocol contagion (DEXs, lending, treasuries holding affected assets)
- **Systemic**: Trust and liquidity disruption across Sonic ecosystem and L1 counterparties

## Remediation Guidance
- Governance & ACL
  - Enforce timelocks and quorum-gated changes; distinct signer sets per function domain; formalize guardian/pauser with limited scopes
  - Fix/update sequencing constraints in UpdateManager; prevent execution if preconditions not met
- Bridge Controls
  - Per-epoch quotas and rolling rate limits per-asset; anomaly detection for mint bursts
  - Multi-party confirmations for high-value mints; on-chain observable thresholds
- Monitoring
  - Real-time alerts for role/validator changes, timelock schedules, adapter configuration edits
  - Alerts for mints/burns above thresholds and burst patterns (per block/epoch)

## Severity Justification
- Single-point compromise can enable unbounded mint across high-value assets
- Cross-chain insolvency with minimal reaction time
- Matches historical high-impact bridge exploit patterns

## Affected (To Be Completed During Submission)
- **Contracts (addresses/ABIs)**: UpdateManager, Gateway core, TokenDeposit (L1), CircleTokenAdapter (Sonic)
- **Roles/Quorums**: validator sets, admins, guardians
- **Networks**: Ethereum L1, Sonic mainnet

## Reproduction / Evidence (To Attach)
- Role/ownership/validator event logs; timelock schedules
- Adapter `mint`/`burn` authorization mappings
- Simulations/logs showing insufficient quotas/rate limits, or unsafe update ordering
- Audit references (OpenZeppelin) and governance notes (Aave EURC discussion)

## Mitigation Plan (Proposed Timeline)
- Immediate: Enable/verify guardian pauses; enforce temporary per-asset mint caps; review validator quorum
- ≤ 7 days: Deploy timelocks, quotas; patch UpdateManager ordering; instrument alerts
- ≤ 30 days: Formal verification for critical paths; implement emergency halts and full monitoring runbooks

## Submission Checklist
- [ ] Contracts/roles enumerated
- [ ] Evidence/logs/simulations attached
- [ ] Concrete remediation steps included
- [ ] Business impact quantified
- [ ] References to public audits/governance discussions provided


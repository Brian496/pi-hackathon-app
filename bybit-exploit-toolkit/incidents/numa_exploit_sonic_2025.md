### Numa Money — Sonic Exploit (2025-08-10)

Incident summary
- Chain: Sonic
- Loss: ~$313K (~74.2 ETH)
- Vector: Vault collateral price manipulation → under-collateralized liquidations → profit extraction → cross-chain laundering
- Key assets: NUMA, cNUMA (collateral cToken), stS (staked Sonic token), nuBTC (synthetic BTC)

Attack overview (high-level)
1) Flash loans: ~1.2M stS and ~120k NUMA sourced from DEX pools
2) Setup: Deposit ~19.2k NUMA → mint ~960k cNUMA; borrow ~138k stS using cNUMA
3) Price manipulation: Call `NumaPrinter` to mint ~3.08 nuBTC using ~100.8k NUMA → spikes total synthetic value, collapsing internal cNUMA price (≈ 7.579e18 → 2.115e18)
4) Liquidations: With cNUMA devalued, multiple accounts become liquidatable; attacker repays victims’ debts, seizes stS collateral across many vaults, and liquidates own position to reclaim NUMA
5) Extraction: Swap stS⇄NUMA opportunistically; burn nuBTC to redeem ~88.1k NUMA; settle flash loans
6) Laundering: Bridge ~973k stS proceeds → Ethereum; convert to ~74.3 ETH; deposit ~74.2 ETH to Tornado Cash

Root cause
- Internal collateral pricing tied to vault balance and total synthetic liabilities without robust external oracles or slippage/rate limits allowed attacker-driven synthetic mints to depress cNUMA price on-demand.
- Similar to April 2025 Arbitrum incident on Numa: lack of real-time price validation and circuit breakers in vault pricing.

On-chain indicators (what to monitor)
- Large same-block flash loan inflows in stS/NUMA into addresses interacting with Numa vaults
- Abnormal spike in nuAsset mints (e.g., nuBTC) from `NumaPrinter`
- Sudden drop in computed cNUMA exchange rate / price indicators (deriveable via on-chain variables if exposed)
- Burst of `liquidateBorrow` (Compound-style) txs from a single EOA/contract against many vaults
- Post-attack swaps stS⇄NUMA and burns of nuAssets to redeem NUMA
- Bridging of large stS/NUMA → Ethereum followed by Tornado Cash deposits

Suggested real-time rules (pseudocode)
- Rule A: If nuAsset mint value > X USD within 1 block and address has recent flash loan inflow → raise HIGH alert
- Rule B: If cNUMA exchange rate drops > Y% within Z blocks → pause liquidations and new borrows (guardian)
- Rule C: If > N liquidations initiated by same sender within M blocks → pause/liquidation throttle
- Rule D: Track bridges from attacker address cluster to ETH → alert on mixer deposits

Defensive actions
- Replace internal collateral valuation with robust oracles (TWAP, Chainlink) and sanity caps
- Add slippage/rate limits for synthetic mints; circuit breakers on sudden liability expansion
- Enforce liquidation throttles; per-block caps; dynamic discounts during abnormal volatility
- Add guardian pause for mint/borrow/liquidation paths; add cooldown between collateral mint and borrow

References
- CertiK Incident & Alert: Tornado deposit tying ~74.2 ETH to Numa exploit
- SolidityScan: April 2025 NumaVault price manipulation (Arbitrum)
- Numa post-mortem (April 2025): internal price manipulation
- Hypernative: early detection of Numa Arbitrum exploit


#!/usr/bin/env bash
set -euo pipefail
echo "🔍 Running vulnerability scan on targets..."
source venv/bin/activate 2>/dev/null || true

RPC_URL="${SONIC_RPC_URL:-${ETH_RPC_URL:-}}"
TARGETS_FILE="${1:-}"

if [[ -n "${TARGETS_FILE}" ]]; then
  python3 vulnerability_scanner.py --rpc "${RPC_URL}" --targets "${TARGETS_FILE}" | tee "vulnerability_report_$(date +%s).txt"
else
  python3 vulnerability_scanner.py --rpc "${RPC_URL}" | tee "vulnerability_report_$(date +%s).txt"
fi

### Prompt Injection & Jailbreaks for Web3 — Operational Audit Checklist

- **Label untrusted content**: Tag and route NFT/token metadata, forums, docs as UNTRUSTED; strip links/HTML/alt/code; remove URLs before LLM
- **Separate instructions vs data**: Block untrusted content from influencing system prompt, goals, or tool policies
- **Connector least-privilege**: Scope tokens (Drive/GitHub/email), disable by default, rotate regularly, log access
- **No-env exposure**: Don’t pass environment variables into model context; use secure stores; inject only per-call secrets via proxies
- **Canary secrets**: Plant decoy secrets; alert on any output/HTTP usage
- **Network egress policy**: Allowlist hosts; block model-crafted URLs unless approved; proxy and log all egress
- **Deterministic output filters**: Regex/AST validators on tool outputs (URLs, txs); drop disallowed patterns
- **Human-in-the-loop**: Require approval for signing, transfers, permission changes; dry-run paths only
- **Session statelessness**: Reset system prompt/capabilities each task; clear prior conversational state
- **Prompt provenance**: Log content sources (on-chain URI, IPFS hash, domain); enable rapid blocking
- **UI cues**: Visually indicate untrusted content to operators; hide active tool capability state from model output
- **Testing**: Run red-team test plan (poisoned metadata, AgentFlayer doc, fake incident page, Crescendo, HouYi)
- **Incident response**: Playbooks for egress spike, canary hits, policy bypass; auto-disable connectors; rotate keys

